import{u as b,r,s as i,j as t,m as c}from"./index-COh0nrvB.js";import{S as T}from"./SpotCard-D_D0TYMj.js";import{T as k}from"./Toast-DAGBCtd8.js";import{S as C}from"./search-B2LGKEwD.js";import"./ImageSlider-fNb6Fewz.js";const L=({lang:x})=>{b();const[u,l]=r.useState([]),[g,o]=r.useState(!0),[a,y]=r.useState(""),[E,f]=r.useState([]),[_,h]=r.useState([]),[n,d]=r.useState(null);r.useEffect(()=>{S(),v(),j()},[]);const S=async()=>{o(!0);const{data:e,error:s}=await i.from("spots").select("*").eq("is_verified",!0).order("created_at",{ascending:!1});s?(console.error("Error fetching spots:",s),d({message:"Failed to load spots",type:"error"})):l(e||[]),o(!1)},v=async()=>{const e=new Date(Date.now()-6048e5),{data:s}=await i.from("spots").select("*, reviews(count)").eq("is_verified",!0).gte("created_at",e.toISOString()).order("reviews.count",{ascending:!1}).limit(5);f(s||[])},j=async()=>{const{data:e}=await i.from("spots").select("*").eq("is_verified",!0).order("created_at",{ascending:!1}).limit(5);h(e||[])},p=async()=>{if(!a.trim())return;o(!0);let e=i.from("spots").select("*").eq("is_verified",!0);a.trim()&&(e=e.ilike("name",a));const{data:s,error:m}=await e;m?(console.error("Search error:",m),d({message:"Search failed",type:"error"})):l(s||[]),o(!1)},w=u.filter(e=>!a||e.name.toLowerCase().includes(a.toLowerCase()));return t.jsxs("div",{style:{minHeight:"100vh",background:"var(--bg-cream)",padding:"20px"},children:[n&&t.jsx(k,{message:n.message,type:n.type,onClose:()=>d(null)}),t.jsxs(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},style:{textAlign:"center",marginBottom:"30px"},children:[t.jsx("h1",{style:{fontSize:"2rem",fontWeight:"900",color:"var(--primary)",marginBottom:"10px"},children:"Explore All Spots"}),t.jsx("p",{style:{color:"var(--text-muted)",fontSize:"1rem"},children:"Discover amazing food spots across Kerala"})]}),t.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},style:{background:"white",padding:"20px",borderRadius:"20px",boxShadow:"var(--shadow-md)",marginBottom:"30px"},children:[t.jsx("div",{style:{display:"flex",gap:"12px",marginBottom:"16px"},children:t.jsxs("div",{style:{flex:1,position:"relative"},children:[t.jsx(C,{size:20,color:"var(--text-muted)",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}}),t.jsx("input",{type:"text",placeholder:"Search for dishes...",value:a,onChange:e=>y(e.target.value),onKeyPress:e=>e.key==="Enter"&&p(),style:{width:"100%",padding:"12px 12px 12px 40px",borderRadius:"16px",border:"2px solid var(--secondary)",background:"var(--bg-cream)",fontSize:"1rem",outline:"none"}})]})}),t.jsx("button",{onClick:p,style:{padding:"12px 24px",borderRadius:"16px",background:"var(--primary)",color:"white",border:"none",fontWeight:"600",cursor:"pointer",width:"100%"},children:"Search"})]}),t.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.8},children:g?t.jsx("div",{style:{textAlign:"center",padding:"40px"},children:t.jsx("div",{style:{fontSize:"1.1rem",color:"var(--text-muted)"},children:"Loading spots..."})}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:w.map(e=>t.jsx(T,{spot:e,lang:x},e.id))})})]})};export{L as default};
