import{j as e,m as o}from"./framer-BMT5hQ7X.js";import{u as B,r as a}from"./router-DOtJe_Np.js";import{u as q,s as i}from"./index-Ia8L7HSV.js";import"./SpotCard-CyBksOGB.js";import{H as A,c as W,P as F,U as M,M as P,S as $,Z as U,d as O,e as l,A as H,f as N,B as V,g as Z,h as K,i as X,L as Y,j as G,k as J}from"./lucide-DqyMvtym.js";import"./vendor-b0vXyz-r.js";import"./supabase-CtFrdYha.js";import"./ImageSlider-D9DlSLMK.js";const pe=({lang:d})=>{const{user:s,signOut:b}=q(),n=B(),[Q,w]=a.useState(!0),[v,_]=a.useState(null),[c,z]=a.useState({spots:0,reviews:0,xp:0}),[u,ee]=a.useState("favorites"),[te,g]=a.useState([]),[se,j]=a.useState(!1),[E,h]=a.useState(!1),[x,k]=a.useState(!1),[m,S]=a.useState(!1);a.useEffect(()=>{if(s){p(),window.addEventListener("focus",p),window.addEventListener("userProfileUpdated",p),window.addEventListener("visitUpdated",p);const t=localStorage.getItem("darkMode")==="true";S(t),t&&document.body.classList.add("dark-mode")}return()=>{window.removeEventListener("focus",p),window.removeEventListener("userProfileUpdated",p),window.removeEventListener("visitUpdated",p)}},[s]),a.useEffect(()=>{s&&D()},[u,s]);const p=async()=>{w(!0);const{data:t}=await i.from("user_preferences").select("*").eq("user_id",s.id).maybeSingle();_(t);const{count:r}=await i.from("spots").select("*",{count:"exact",head:!0}).eq("created_by",s.id),{count:f}=await i.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",s.id),{count:y}=await i.from("user_favorites").select("*",{count:"exact",head:!0}).eq("user_id",s.id),{count:C}=await i.from("visited_spots").select("*",{count:"exact",head:!0}).eq("user_id",s.id);z({spots:r||0,reviews:f||0,favorites:y||0,visits:C||0,xp:(r||0)*100+(f||0)*10+(C||0)*5}),w(!1)},D=async()=>{if(j(!0),u==="favorites"){const{data:t}=await i.from("user_favorites").select("spot_id").eq("user_id",s.id);if(t&&t.length>0){const r=t.map(y=>y.spot_id),{data:f}=await i.from("spots").select("*").in("id",r);g(f||[])}else g([])}else if(u==="reviews"){const{data:t}=await i.from("reviews").select("*, spots(name)").eq("user_id",s.id).order("created_at",{ascending:!1});g(t||[])}else if(u==="added"){const{data:t}=await i.from("spots").select("*").eq("created_by",s.id).order("created_at",{ascending:!1});g(t||[])}j(!1)},I=async()=>{await b(),n(`/${d||"en"}/login`)},R=()=>{const t=!m;S(t),t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),localStorage.setItem("darkMode",t.toString())},T=async()=>{if(s){k(!0);try{const{data:t}=await i.from("user_preferences").select("user_id").eq("username","admin").maybeSingle(),r=t?.user_id;if(!r)throw new Error("Admin user not found. Please contact support.");await i.from("community_posts").delete().eq("user_id",s.id),await i.from("post_comments").delete().eq("user_id",s.id),await i.from("reviews").delete().eq("user_id",s.id),await i.from("user_favorites").delete().eq("user_id",s.id),await i.from("visited_spots").delete().eq("user_id",s.id),await i.from("spots").update({created_by:r}).eq("created_by",s.id),await i.from("user_preferences").delete().eq("user_id",s.id),await i.auth.updateUser({data:{deleted:!0,email:`deleted_${s.id}@deleted.com`}}),await b(),n(`/${d||"en"}/login`)}catch(t){console.error("Error deleting account:",t),alert("Error deleting account: "+t.message)}finally{k(!1),h(!1)}}},L=[{id:"favorites",label:"Favorites",icon:A,count:c.favorites},{id:"reviews",label:"Reviews",icon:W,count:c.reviews},{id:"added",label:"Added",icon:F,count:c.spots}];return e.jsxs("div",{style:{paddingBottom:"120px",background:"var(--bg-white)",minHeight:"100vh"},children:[e.jsx("div",{style:{height:"180px",background:"linear-gradient(135deg, var(--primary) 0%, #FF6B6B 100%)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{position:"absolute",inset:0,opacity:.1,backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}})}),e.jsxs("div",{style:{marginTop:"-60px",textAlign:"center",padding:"0 20px",position:"relative"},children:[e.jsx(o.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},style:{width:"120px",height:"120px",borderRadius:"40px",background:"white",margin:"0 auto",padding:"6px",boxShadow:"var(--shadow-lg)"},children:e.jsx("div",{style:{width:"100%",height:"100%",borderRadius:"34px",overflow:"hidden",background:"var(--secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:v?.avatar_url?e.jsx("img",{src:v.avatar_url,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(M,{size:50,color:"var(--text-muted)"})})}),e.jsx("h1",{style:{marginTop:"16px",fontSize:"1.6rem",fontWeight:"900",color:"var(--text-main)",margin:"16px 0 4px 0"},children:v?.display_name||s?.user_metadata?.full_name||"Foodie Voyager"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.95rem",fontWeight:"500"},children:"Elite Level Discoverer â€¢ Kerala, IN"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",padding:"24px 20px"},children:[{label:"Visits",value:c.visits,icon:P},{label:"Reviews",value:c.reviews,icon:$},{label:"Added",value:c.spots,icon:F},{label:"XP",value:c.xp,icon:U}].map((t,r)=>e.jsxs("div",{style:{background:"var(--secondary)",padding:"16px 8px",borderRadius:"24px",textAlign:"center"},children:[e.jsx(t.icon,{size:20,color:"var(--primary)",style:{marginBottom:"8px"}}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"900",color:"var(--text-main)"},children:t.value}),e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"700",color:"var(--text-muted)",marginTop:"2px"},children:t.label})]},r))}),e.jsx("div",{style:{padding:"0 20px",marginBottom:"20px"},children:e.jsx("div",{style:{display:"flex",gap:"8px",background:"var(--secondary)",padding:"6px",borderRadius:"20px"},children:L.map(t=>e.jsxs("button",{onClick:()=>n(`/${d}/profile/${t.id}`),style:{flex:1,padding:"12px",borderRadius:"16px",background:"transparent",border:"none",fontWeight:"800",fontSize:"0.85rem",color:"var(--text-muted)",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx(t.icon,{size:16}),t.label," (",t.count,")"]},t.id))})}),e.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"12px",marginTop:"20px"},children:[e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/settings`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#EEF2FF"},children:e.jsx(O,{size:22,color:"#4F46E5"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Settings"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/leaderboard`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#FFFBEB"},children:e.jsx(H,{size:22,color:"#F59E0B"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Leaderboard"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/privacy-policy`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#F0FDF4"},children:e.jsx(N,{size:22,color:"#10B981"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Privacy Policy"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/saved-posts`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderRadius:"16px",background:"white",border:"1px solid #E5E7EB",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:t=>t.target.style.background="#F9FAFB",onMouseOut:t=>t.target.style.background="white",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#F0FDF4"},children:e.jsx(V,{size:22,color:"#10B981"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Saved Posts"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/contact-admin`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#FEF2F2"},children:e.jsx(Z,{size:22,color:"#EF4444"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Contact Admin"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:R,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:m?"#1F2937":"#FEF3C7"},children:m?e.jsx(K,{size:22,color:"#F59E0B"}):e.jsx(X,{size:22,color:"#F59E0B"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:m?"Dark Mode":"Light Mode"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:I,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#F3F4F6"},children:e.jsx(Y,{size:22,color:"#6B7280"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Logout"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>h(!0),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid #FEE2E2"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#FEE2E2"},children:e.jsx(G,{size:22,color:"#DC2626"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"#DC2626"},children:"Delete Account"})]}),e.jsx(l,{size:20,color:"#DC2626"})]})]}),E&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"24px",padding:"32px",maxWidth:"400px",width:"100%",textAlign:"center"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"#FEE2E2",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"},children:e.jsx(J,{size:30,color:"#DC2626"})}),e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"900",color:"var(--text-main)",marginBottom:"12px"},children:"Delete Account?"}),e.jsx("p",{style:{color:"var(--text-muted)",lineHeight:"1.6",marginBottom:"24px"},children:"This action cannot be undone. All your data including posts, reviews, favorites, and visits will be permanently deleted. Your added spots will be transferred to admin."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:()=>h(!1),disabled:x,style:{flex:1,padding:"16px",borderRadius:"16px",border:"2px solid var(--secondary)",background:"white",color:"var(--text-main)",fontWeight:"800",cursor:x?"not-allowed":"pointer"},children:"Cancel"}),e.jsx("button",{onClick:T,disabled:x,style:{flex:1,padding:"16px",borderRadius:"16px",border:"none",background:"#DC2626",color:"white",fontWeight:"800",cursor:x?"not-allowed":"pointer",opacity:x?.7:1},children:x?"Deleting...":"Delete Forever"})]})]})})]})};export{pe as default};
