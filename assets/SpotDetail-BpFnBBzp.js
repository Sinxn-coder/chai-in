import{j as e,m as R,A as ae}from"./framer-BMT5hQ7X.js";import{r as u,d as oe,u as le}from"./router-DOtJe_Np.js";import{u as de,s as l}from"./index-0pshee61.js";import{I as ce}from"./ImageSlider-BY26yJR7.js";import{S as T,x as K,X as pe,b as ge,D as xe,z as V,M as P,F as ue,G as me,y as he,R as fe,H as ye,V as be,g as ve,N as je}from"./lucide-BSDTtmIP.js";import"./vendor-b0vXyz-r.js";import"./supabase-CtFrdYha.js";const _e=({rating:g=0,onRatingChange:o,readonly:v=!1,size:i=24,color:n="#f59e0b",showValue:z=!1})=>{const[I,m]=u.useState(0),[j,_]=u.useState(g),E=r=>{v||m(r)},y=()=>{v||m(0)},a=r=>{!v&&o&&(_(r),o(r))},d=I||j;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx("div",{style:{display:"flex",gap:"2px"},children:[1,2,3,4,5].map(r=>{const h=r<=d,w=r===Math.ceil(d)&&d%1!==0;return e.jsx("div",{onMouseEnter:()=>E(r),onMouseLeave:y,onClick:()=>a(r),style:{cursor:v?"default":"pointer",transition:"transform 0.2s ease",transform:I===r&&!v?"scale(1.1)":"scale(1)"},children:e.jsx(T,{size:i,fill:h?n:"none",color:h?n:"#d1d5db",strokeWidth:w?0:2,style:{filter:h?"drop-shadow(0 2px 4px rgba(245, 158, 11, 0.3))":"none"}})},r)})}),z&&e.jsx("span",{style:{fontSize:i*.6,fontWeight:"600",color:"#374151",marginLeft:"8px"},children:j.toFixed(1)})]})},we=({spot:g,onClose:o,onSubmit:v})=>{const[i,n]=u.useState({name:g.name||"",description:g.description||"",location_text:g.location_text||"",opening_time:g.opening_hours?.open||"10:00",closing_time:g.opening_hours?.close||"22:00",tags:g.tags?g.tags.join(", "):"",price_level:g.price_level||1,category:g.category||"",instagram_handle:g.instagram_handle||"",whatsapp_number:g.whatsapp_number||""}),[z,I]=u.useState(!1),[m,j]=u.useState({}),_=(a,d)=>{if(n(r=>({...r,[a]:d})),a==="opening_time"||a==="closing_time"){const r={open:g.opening_hours?.open||"10:00",close:g.opening_hours?.close||"22:00"},h={open:a==="opening_time"?d:i.opening_time,close:a==="closing_time"?d:i.closing_time};JSON.stringify(r)!==JSON.stringify(h)?j(w=>({...w,opening_hours:{old:r,new:h}})):j(w=>{const S={...w};return delete S.opening_hours,S})}else d!==g[a]?j(r=>({...r,[a]:{old:g[a],new:d}})):j(r=>{const h={...r};return delete h[a],h})},E=async a=>{if(a.preventDefault(),Object.keys(m).length===0){alert("Please make at least one change to suggest edits");return}I(!0);try{const d={...i,opening_hours:{open:i.opening_time,close:i.closing_time}};await v({spot_id:g.id,suggested_changes:m,original_data:g,suggested_data:d}),o()}catch(d){console.error("Error submitting edits:",d),alert("Failed to submit edits. Please try again.")}finally{I(!1)}},y=(a,d,r,h="text",w="")=>e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"600",color:"var(--text-main)"},children:[r,d]}),h==="textarea"?e.jsx("textarea",{value:i[a],onChange:S=>_(a,S.target.value),placeholder:w,style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.9rem",resize:"vertical",minHeight:"80px",fontFamily:"inherit"}}):e.jsx("input",{type:h,value:i[a],onChange:S=>_(a,S.target.value),placeholder:w,style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.9rem",fontFamily:"inherit"}})]});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",zIndex:1e3},children:e.jsxs(R.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},style:{background:"white",borderRadius:"20px",width:"100%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",position:"relative"},children:[e.jsxs("div",{style:{padding:"24px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(K,{size:24,color:"var(--primary)"}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"1.3rem",color:"var(--text-main)"},children:"Suggest Edits"}),e.jsx("p",{style:{margin:0,fontSize:"0.85rem",color:"var(--text-muted)"},children:g.name})]})]}),e.jsx("button",{onClick:o,style:{background:"none",border:"none",cursor:"pointer",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(pe,{size:20,color:"var(--text-muted)"})})]}),e.jsxs("form",{onSubmit:E,style:{padding:"24px"},children:[e.jsx("div",{style:{marginBottom:"20px",padding:"12px",background:"#fef3c7",borderRadius:"12px",border:"1px solid #fbbf24"},children:e.jsx("p",{style:{margin:0,fontSize:"0.85rem",color:"#92400e",fontWeight:"600"},children:"ðŸ’¡ Only fill in the fields you want to edit. Empty fields will be ignored."})}),y("name","Spot Name",e.jsx(P,{size:16}),"text","Enter spot name"),y("description","Description",e.jsx(ue,{size:16}),"textarea","Describe the spot..."),y("location_text","Location",e.jsx(P,{size:16}),"text","Enter location details"),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"600",color:"var(--text-main)"},children:[e.jsx(ge,{size:16}),"Opening Hours"]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",flex:1},children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:"800",color:"var(--text-muted)"},children:"Opening"}),e.jsx("input",{type:"time",value:i.opening_time,onChange:a=>_("opening_time",a.target.value),style:{padding:"12px",borderRadius:"14px",background:"var(--secondary)",border:"none",fontWeight:"700",width:"100%"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",flex:1},children:[e.jsx("label",{style:{fontSize:"0.75rem",fontWeight:"800",color:"var(--text-muted)"},children:"Closing"}),e.jsx("input",{type:"time",value:i.closing_time,onChange:a=>_("closing_time",a.target.value),style:{padding:"12px",borderRadius:"14px",background:"var(--secondary)",border:"none",fontWeight:"700",width:"100%"}})]})]})]}),y("tags","Tags",e.jsx(V,{size:16}),"text","e.g., biryani, tea, snacks (comma separated)"),y("instagram_handle","Instagram",e.jsx(me,{size:16}),"text","@username"),y("whatsapp_number","WhatsApp",e.jsx(he,{size:16}),"tel","Enter WhatsApp number"),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"600",color:"var(--text-main)"},children:[e.jsx(xe,{size:16}),"Price Level"]}),e.jsxs("select",{value:i.price_level,onChange:a=>_("price_level",parseInt(a.target.value)),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.9rem",fontFamily:"inherit"},children:[e.jsx("option",{value:1,children:"â‚¹50-150 (Budget)"}),e.jsx("option",{value:2,children:"â‚¹150-300 (Moderate)"}),e.jsx("option",{value:3,children:"â‚¹300-600 (Expensive)"}),e.jsx("option",{value:4,children:"â‚¹600+ (Premium)"})]})]}),e.jsxs("div",{style:{marginBottom:"16px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"0.9rem",fontWeight:"600",color:"var(--text-main)"},children:[e.jsx(V,{size:16}),"Category"]}),e.jsxs("select",{value:i.category,onChange:a=>_("category",a.target.value),style:{width:"100%",padding:"12px",border:"2px solid #e5e7eb",borderRadius:"12px",fontSize:"0.9rem",fontFamily:"inherit"},children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"restaurant",children:"Restaurant"}),e.jsx("option",{value:"cafe",children:"Cafe"}),e.jsx("option",{value:"tea_shop",children:"Tea Shop"}),e.jsx("option",{value:"bakery",children:"Bakery"}),e.jsx("option",{value:"juice_bar",children:"Juice Bar"}),e.jsx("option",{value:"street_food",children:"Street Food"}),e.jsx("option",{value:"fast_food",children:"Fast Food"}),e.jsx("option",{value:"dessert",children:"Dessert"})]})]}),Object.keys(m).length>0&&e.jsxs("div",{style:{marginBottom:"20px",padding:"16px",background:"#f0fdf4",borderRadius:"12px",border:"1px solid #86efac"},children:[e.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:"0.9rem",color:"#166534",fontWeight:"600"},children:["ðŸ“ Changes Summary (",Object.keys(m).length," changes)"]}),Object.entries(m).map(([a,{old:d,new:r}])=>e.jsxs("div",{style:{marginBottom:"8px",fontSize:"0.85rem",color:"#166534"},children:[e.jsxs("strong",{children:[a,":"]})," ",a==="opening_hours"?`"${d?.open||"10:00"} - ${d?.close||"22:00"}" â†’ "${r?.open||"10:00"} - ${r?.close||"22:00"}"`:`"${d}" â†’ "${r}"`]},a))]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:o,style:{padding:"12px 24px",border:"2px solid #e5e7eb",background:"white",borderRadius:"12px",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",color:"var(--text-main)"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:z||Object.keys(m).length===0,style:{padding:"12px 24px",border:"none",background:"var(--primary)",color:"white",borderRadius:"12px",fontSize:"0.9rem",fontWeight:"600",cursor:z?"not-allowed":"pointer",opacity:z||Object.keys(m).length===0?.6:1},children:z?"Submitting...":`Submit ${Object.keys(m).length} Changes`})]})]})]})})},Fe=({lang:g})=>{const{id:o}=oe(),v=le(),{user:i}=de(),[n,z]=u.useState(null),[I,m]=u.useState([]),[j,_]=u.useState(""),[E,y]=u.useState(!1),[a,d]=u.useState(!0),[r,h]=u.useState(null),[w,S]=u.useState(!1),[G,q]=u.useState(!1),[O,F]=u.useState(""),[C,B]=u.useState(0),[Se,J]=u.useState(0),[X,U]=u.useState(!1),[$,A]=u.useState(0),[D,H]=u.useState(!1);u.useEffect(()=>{M();const t=()=>{W()};window.addEventListener("userProfileUpdated",t);const s=l.channel("user_preferences_changes_reviews").on("postgres_changes",{event:"UPDATE",schema:"public",table:"user_preferences"},x=>{W()}).subscribe(),c=l.channel("spot_ratings_changes_detail").on("postgres_changes",{event:"*",schema:"public",table:"spot_ratings",filter:`spot_id=eq.${o}`},x=>{console.log("SpotDetail received rating change:",x),M()}).subscribe();return()=>{window.removeEventListener("userProfileUpdated",t),l.removeChannel(s),l.removeChannel(c)}},[o]);const N=t=>t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString(),Y=async t=>{try{const{data:s,error:c}=await l.from("spot_edit_suggestions").insert([{spot_id:t.spot_id,user_id:i.id,suggested_changes:t.suggested_changes,original_data:t.original_data,suggested_data:t.suggested_data,status:"pending"}]);if(c)throw console.error("Error submitting suggestion:",c),c;alert("Edit suggestion submitted successfully! The admin will review it soon.")}catch(s){throw console.error("Error submitting edit suggestion:",s),s}},Z=()=>new Date(new Date().toLocaleString("en-US",{timeZone:"Asia/Kolkata"})),Q=t=>{if(!t||!t.open||!t.close)return null;const s=Z(),[c,x=0]=t.open.split(":").map(Number),[b,f=0]=t.close.split(":").map(Number),p=new Date(s);p.setHours(c,x,0,0);const k=new Date(s);return k.setHours(b,f,0,0),k<=p&&(s<p?p.setDate(p.getDate()-1):k.setDate(k.getDate()+1)),s>=p&&s<=k},L=t=>{if(!t)return"â€”";const[s,c="00"]=t.split(":"),x=new Date;return x.setHours(Number(s),Number(c),0,0),x.toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})},M=async()=>{d(!0),F("");try{const{data:t,error:s}=await l.from("spots").select("*").eq("id",parseInt(o)).single();if(s)throw s;if(!t){F("Spot not found"),d(!1);return}if(z(t),h(Q(t.opening_hours)),W(),ee(),i){const{data:c}=await l.from("user_favorites").select("*").eq("spot_id",parseInt(o)).eq("user_id",i.id).maybeSingle();y(!!c);const{data:x}=await l.from("visited_spots").select("*").eq("spot_id",parseInt(o)).eq("user_id",i.id).maybeSingle();S(!!x);const{data:b}=await l.from("spot_ratings").select("rating").eq("spot_id",parseInt(o)).eq("user_id",i.id).maybeSingle();A(b?.rating||0)}}catch(t){console.error("Error fetching spot:",t),F("Unable to load this spot right now. Please try again.")}finally{d(!1)}},W=async()=>{const{data:t,error:s}=await l.from("reviews").select("*").eq("spot_id",o).order("created_at",{ascending:!1});if(s){console.error("Error loading reviews:",s),m([]);return}if(t){const c=[...new Set(t.map(p=>p.user_id))],{data:x}=await l.from("user_preferences").select("user_id, display_name, avatar_url").in("user_id",c),b={};x?.forEach(p=>b[p.user_id]=p);const{data:{user:f}}=await l.auth.getUser();m(t.map(p=>{const k=b[p.user_id];return k?{...p,user:k}:f&&p.user_id===f.id?{...p,user:{display_name:f.user_metadata?.full_name||f.email?.split("@")[0]||"User",avatar_url:f.user_metadata?.avatar_url||null}}:{...p,user:{display_name:"User",avatar_url:null}}}))}else m([])},ee=async()=>{try{const{count:t}=await l.from("visited_spots").select("*",{count:"exact",head:!0}).eq("spot_id",parseInt(o));B(t||0)}catch(t){console.error("Error fetching visit count:",t)}},te=async()=>{if(!i)return alert("Please login!");const t=E;y(!t);try{t?await l.from("user_favorites").delete().eq("spot_id",parseInt(o)).eq("user_id",i.id):await l.from("user_favorites").insert({spot_id:parseInt(o),user_id:i.id})}catch(s){console.error("Error toggling favorite:",s),y(t)}},ie=async()=>{if(!i)return alert("Please login!");const t=w,s=!t,c=t?C-1:C+1;S(s),J(C),B(c),t||(U(!0),setTimeout(()=>U(!1),600));try{t?await l.from("visited_spots").delete().eq("spot_id",parseInt(o)).eq("user_id",i.id):await l.from("visited_spots").insert({spot_id:parseInt(o),user_id:i.id}),window.dispatchEvent(new CustomEvent("visitUpdated",{detail:{userId:i.id,visited:s}}))}catch(x){console.error("Error toggling visit:",x),S(t),B(t?C+1:C-1)}},se=async t=>{if(!i)return alert("Please login to rate!");if(!D){console.log("Submitting rating:",t,"for spot:",o,"by user:",i.id),H(!0);try{const{data:s,error:c}=await l.from("spot_ratings").select("*").eq("spot_id",parseInt(o)).eq("user_id",i.id).single();if(c&&c.code!=="PGRST116")throw console.error("Error fetching existing rating:",c),c;let x;if(s){const{data:f,error:p}=await l.from("spot_ratings").update({rating:t}).eq("id",s.id);x={data:f,error:p},console.log("Updated existing rating:",{data:f,error:p})}else{const{data:f,error:p}=await l.from("spot_ratings").insert({spot_id:parseInt(o),user_id:i.id,rating:t});x={data:f,error:p},console.log("Inserted new rating:",{data:f,error:p})}if(x.error)throw console.error("Supabase error:",x.error),x.error;A(t);const{data:b}=await l.from("spots").select("*").eq("id",parseInt(o)).single();b&&z(b)}catch(s){console.error("Error submitting rating:",s),alert(`Failed to submit rating: ${s.message||s.details||"Unknown error"}`)}finally{H(!1)}}},ne=async()=>{if(!i)return alert("Please login to submit a review!");if(!j.trim())return;const{data:t}=await l.from("user_preferences").select("*").eq("user_id",i.id).maybeSingle();t||await l.from("user_preferences").insert({user_id:i.id,display_name:i.user_metadata?.full_name||i.email?.split("@")[0]||"User",avatar_url:i.user_metadata?.avatar_url||null,notifications_enabled:!0,notify_new_spots:!0,notify_review_replies:!0,notify_weekly_digest:!1});const{error:s}=await l.from("reviews").insert({spot_id:parseInt(o),user_id:i.id,comment:j,rating:5});s?console.error("Error adding review:",s):(_(""),W())},re=()=>{if(!n?.latitude||!n?.longitude){alert("Location coordinates not available for this spot.");return}const t=n.latitude,s=n.longitude,c=encodeURIComponent(n.name||"Spot"),x=/iPad|iPhone|iPod/.test(navigator.userAgent),b=`/${window.location.pathname.includes("/ml/")?"ml":"en"}/directions/${o}`;x?(v(b),setTimeout(()=>{window.open(`maps://?daddr=${t},${s}&q=${c}`,"_blank")},100)):(window.open(`https://www.google.com/maps/dir/?api=1&destination=${t},${s}&destination_place_id=${c}`,"_blank"),setTimeout(()=>{v(b)},100))};return a?e.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Wait a moment..."}):O?e.jsx("div",{style:{padding:"40px",textAlign:"center"},children:O}):n?e.jsxs("div",{style:{background:"var(--bg-white)",minHeight:"100vh",position:"relative",paddingBottom:"140px"},children:[e.jsxs("div",{style:{height:"45vh",position:"relative",background:"#000"},children:[e.jsx(ce,{images:n.images&&n.images.length?n.images:["https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=900&q=80"]}),e.jsx("div",{style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(8px)",padding:"6px 12px",borderRadius:"20px",display:"flex",alignItems:"center",gap:"4px",zIndex:5},children:e.jsxs("span",{style:{color:"white",fontSize:"0.75rem",fontWeight:"700"},children:[N(C)," visits"]})}),e.jsx(R.button,{whileTap:{scale:.9},onClick:()=>v(-1),style:{position:"absolute",top:"24px",left:"20px",background:"white",border:"none",borderRadius:"16px",padding:"12px",boxShadow:"var(--shadow-md)",zIndex:10},children:e.jsx(fe,{size:24,color:"var(--text-main)"})}),e.jsx(R.button,{whileTap:{scale:.9},onClick:te,style:{position:"absolute",top:"24px",right:"20px",background:"white",border:"none",borderRadius:"16px",padding:"12px",boxShadow:"var(--shadow-md)",zIndex:10},children:e.jsx(ye,{size:24,fill:E?"var(--primary)":"none",color:E?"var(--primary)":"var(--text-main)"})})]}),e.jsxs(R.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},style:{background:"white",marginTop:"-40px",borderRadius:"40px 40px 0 0",padding:"30px 20px",position:"relative",boxShadow:"0 -10px 30px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:"900",margin:0,color:"var(--text-main)"},children:n.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[e.jsx("span",{style:{background:r===null?"#E5E7EB":r?"rgba(16, 185, 129, 0.12)":"rgba(239, 68, 68, 0.12)",color:r===null?"#4B5563":r?"#0F9F6E":"#B91C1C",padding:"6px 12px",borderRadius:"12px",fontWeight:"800",fontSize:"0.8rem"},children:r===null?"HOURS NOT SET":r?"OPEN NOW":"CLOSED"}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:"0.85rem",fontWeight:"700"},children:[L(n.opening_hours?.open)," - ",L(n.opening_hours?.close)," (Kerala)"]})]})]}),e.jsxs("div",{style:{background:"var(--secondary)",padding:"10px 16px",borderRadius:"16px",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(T,{size:18,fill:"#FFB800",color:"#FFB800"}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.1rem"},children:(n.average_rating||n.rating||0).toFixed(1)}),n.total_ratings&&e.jsxs("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)",marginLeft:"4px"},children:["(",n.total_ratings,")"]})]})]}),e.jsx("div",{style:{display:"flex",gap:"10px",marginBottom:"24px"},children:n.tags&&n.tags.map(t=>e.jsxs("span",{style:{background:"var(--secondary)",color:"var(--text-muted)",padding:"6px 14px",borderRadius:"12px",fontSize:"0.8rem",fontWeight:"700"},children:["#",t]},t))}),e.jsx("p",{style:{lineHeight:"1.6",color:"var(--text-main)",fontSize:"1rem",marginBottom:"30px"},children:n.description||"Indulge in an exquisite culinary journey at this magnificent location. Known for its exceptional service and vibrant atmosphere."}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"40px",flexWrap:"wrap"},children:[n.instagram_handle&&e.jsxs("a",{href:`https://instagram.com/${n.instagram_handle}`,style:{flex:"1 1 120px",minWidth:"120px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"10px 12px",borderRadius:"12px",background:"linear-gradient(45deg, #f09433 0%, #dc2743 100%)",color:"white",textDecoration:"none",fontWeight:"700",fontSize:"0.85rem"},children:[e.jsx(be,{size:16})," Instagram"]}),n.whatsapp_number&&e.jsxs("a",{href:`https://wa.me/${n.whatsapp_number}`,style:{flex:"1 1 120px",minWidth:"120px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"10px 12px",borderRadius:"12px",background:"#25D366",color:"white",textDecoration:"none",fontWeight:"700",fontSize:"0.85rem"},children:[e.jsx(ve,{size:16})," WhatsApp"]}),e.jsxs(R.button,{whileTap:{scale:.95},onClick:re,style:{flex:"1 1 120px",minWidth:"120px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"10px 12px",borderRadius:"12px",background:"var(--primary)",color:"white",border:"none",textDecoration:"none",fontWeight:"700",cursor:"pointer",fontSize:"0.85rem"},children:[e.jsx(je,{size:16})," Directions"]})]}),e.jsxs("div",{style:{marginBottom:"32px",padding:"20px",background:"var(--bg-white)",borderRadius:"20px",border:"1px solid rgba(0,0,0,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.2rem",fontWeight:"800",color:"var(--text-main)"},children:"Rate this spot"}),n.total_ratings>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(T,{size:20,fill:"#FFB800",color:"#FFB800"}),e.jsx("span",{style:{fontWeight:"700",fontSize:"1rem"},children:(n.average_rating||0).toFixed(1)}),e.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:["(",n.total_ratings," ",n.total_ratings===1?"rating":"ratings",")"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(_e,{rating:$,onRatingChange:se,readonly:!i||D,size:32}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-muted)",marginBottom:"4px"},children:i?$>0?"Your rating":"Tap stars to rate":"Login to rate"}),D&&e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--primary)"},children:"Saving..."})]})]})]}),e.jsx("div",{style:{position:"sticky",bottom:"20px",left:0,right:0,zIndex:10,padding:"0 4px",marginBottom:"40px"},children:e.jsxs(R.button,{whileTap:{scale:.95},onClick:ie,style:{width:"100%",padding:"18px",borderRadius:"24px",background:w?"#10B981":"#EF4444",color:"white",border:"none",fontSize:"1.1rem",fontWeight:"900",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:"var(--shadow-lg)"},children:[e.jsx(P,{size:24}),"VISITED",e.jsx(ae,{mode:"wait",children:X&&e.jsx(R.span,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.5,ease:"easeOut"},style:{background:"rgba(255,255,255,0.2)",padding:"2px 8px",borderRadius:"12px",fontSize:"0.9rem"},children:N(C)},C)})]})}),e.jsxs(R.button,{whileTap:{scale:.95},onClick:()=>q(!0),style:{width:"100%",padding:"16px",borderRadius:"20px",background:"var(--bg-white)",color:"var(--text-main)",border:"2px solid var(--primary)",fontWeight:"800",fontSize:"1rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",boxShadow:"var(--shadow-md)",marginBottom:"40px"},children:[e.jsx(K,{size:20}),"Suggest Edits"]}),e.jsxs("div",{style:{marginBottom:"40px"},children:[e.jsxs("h2",{style:{fontSize:"1.4rem",fontWeight:"900",marginBottom:"20px"},children:["Reviews (",I.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:I.map(t=>e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("img",{src:t.user?.avatar_url||"https://i.pravatar.cc/40",style:{width:"40px",height:"40px",borderRadius:"50%"}}),e.jsxs("div",{children:[e.jsx("p",{style:{fontWeight:"800",margin:0},children:t.user?.display_name||"Anonymous"}),e.jsx("p",{style:{margin:"4px 0 0 0",color:"var(--text-main)"},children:t.comment})]})]},t.id))}),e.jsxs("div",{style:{marginTop:"24px",display:"flex",gap:"10px"},children:[e.jsx("input",{type:"text",value:j,onChange:t=>_(t.target.value),placeholder:"Add a review...",style:{flex:1,padding:"14px",borderRadius:"16px",border:"2px solid var(--secondary)",outline:"none",fontWeight:"700"}}),e.jsx("button",{onClick:ne,style:{padding:"14px 20px",borderRadius:"16px",background:"var(--primary)",color:"white",border:"none",fontWeight:"800"},children:"Send"})]})]})]}),G&&n&&e.jsx(we,{spot:n,onClose:()=>q(!1),onSubmit:Y})]}):e.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Spot disappeared..."})};export{Fe as default};
