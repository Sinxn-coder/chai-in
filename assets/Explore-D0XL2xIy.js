import{j as t,m as c}from"./framer-BMT5hQ7X.js";import{u as b,r as s}from"./router-DOtJe_Np.js";import{s as i}from"./index-CmlotxwV.js";import{S as T}from"./SpotCard-BTTKwZZk.js";import{T as k}from"./Toast-DsHB9n-F.js";import{a as C}from"./lucide-BSDTtmIP.js";import"./vendor-b0vXyz-r.js";import"./supabase-CtFrdYha.js";import"./ImageSlider-BY26yJR7.js";const M=({lang:x})=>{b();const[u,l]=s.useState([]),[f,a]=s.useState(!0),[o,g]=s.useState(""),[E,y]=s.useState([]),[_,h]=s.useState([]),[n,d]=s.useState(null);s.useEffect(()=>{v(),S(),j()},[]);const v=async()=>{a(!0);const{data:e,error:r}=await i.from("spots").select("*").eq("is_verified",!0).order("created_at",{ascending:!1});r?(console.error("Error fetching spots:",r),d({message:"Failed to load spots",type:"error"})):l(e||[]),a(!1)},S=async()=>{const e=new Date(Date.now()-6048e5),{data:r}=await i.from("spots").select("*, reviews(count)").eq("is_verified",!0).gte("created_at",e.toISOString()).order("reviews.count",{ascending:!1}).limit(5);y(r||[])},j=async()=>{const{data:e}=await i.from("spots").select("*").eq("is_verified",!0).order("created_at",{ascending:!1}).limit(5);h(e||[])},p=async()=>{if(!o.trim())return;a(!0);let e=i.from("spots").select("*").eq("is_verified",!0);o.trim()&&(e=e.ilike("name",o));const{data:r,error:m}=await e;m?(console.error("Search error:",m),d({message:"Search failed",type:"error"})):l(r||[]),a(!1)},w=u.filter(e=>!o||e.name.toLowerCase().includes(o.toLowerCase()));return t.jsxs("div",{style:{minHeight:"100vh",background:"var(--bg-cream)",padding:"20px"},children:[n&&t.jsx(k,{message:n.message,type:n.type,onClose:()=>d(null)}),t.jsxs(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},style:{textAlign:"center",marginBottom:"30px"},children:[t.jsx("h1",{style:{fontSize:"2rem",fontWeight:"900",color:"var(--primary)",marginBottom:"10px"},children:"Explore All Spots"}),t.jsx("p",{style:{color:"var(--text-muted)",fontSize:"1rem"},children:"Discover amazing food spots across Kerala"})]}),t.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},style:{background:"white",padding:"20px",borderRadius:"20px",boxShadow:"var(--shadow-md)",marginBottom:"30px"},children:[t.jsx("div",{style:{display:"flex",gap:"12px",marginBottom:"16px"},children:t.jsxs("div",{style:{flex:1,position:"relative"},children:[t.jsx(C,{size:20,color:"var(--text-muted)",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}}),t.jsx("input",{type:"text",placeholder:"Search for dishes...",value:o,onChange:e=>g(e.target.value),onKeyPress:e=>e.key==="Enter"&&p(),style:{width:"100%",padding:"12px 12px 12px 40px",borderRadius:"16px",border:"2px solid var(--secondary)",background:"var(--bg-cream)",fontSize:"1rem",outline:"none"}})]})}),t.jsx("button",{onClick:p,style:{padding:"12px 24px",borderRadius:"16px",background:"var(--primary)",color:"white",border:"none",fontWeight:"600",cursor:"pointer",width:"100%"},children:"Search"})]}),t.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.8},children:f?t.jsx("div",{style:{textAlign:"center",padding:"40px"},children:t.jsx("div",{style:{fontSize:"1.1rem",color:"var(--text-muted)"},children:"Loading spots..."})}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:w.map(e=>t.jsx(T,{spot:e,lang:x},e.id))})})]})};export{M as default};
