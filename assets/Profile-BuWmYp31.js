import{c as x,a as A,u as L,r as a,s as i,H as B,j as e,m as o,M as W,S as $}from"./index-COh0nrvB.js";import"./SpotCard-D_D0TYMj.js";import{M as P}from"./message-square-ZYz386k0.js";import{P as C}from"./plus-x5tXWeQL.js";import{U as N}from"./user-HDZr0AhV.js";import{C as l}from"./chevron-right-C9huPQVK.js";import{S as U}from"./shield-D1GeM27O.js";import{B as H}from"./bookmark-bqAuqwUz.js";import{M as O}from"./message-circle-DB4wNJwR.js";import{T as V}from"./trash-2-COTVM_6R.js";import"./ImageSlider-fNb6Fewz.js";const K=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],X=x("award",K);const Y=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Z=x("log-out",Y);const G=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],J=x("moon",G);const Q=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ee=x("settings",Q);const te=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],se=x("sun",te);const ie=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ae=x("triangle-alert",ie);const re=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],oe=x("zap",re),je=({lang:d})=>{const{user:s,signOut:w}=A(),n=L(),[de,j]=a.useState(!0),[f,F]=a.useState(null),[c,E]=a.useState({spots:0,reviews:0,xp:0}),[g,ne]=a.useState("favorites"),[le,m]=a.useState([]),[ce,k]=a.useState(!1),[D,v]=a.useState(!1),[u,_]=a.useState(!1),[h,S]=a.useState(!1);a.useEffect(()=>{if(s){p(),window.addEventListener("focus",p),window.addEventListener("userProfileUpdated",p),window.addEventListener("visitUpdated",p);const t=localStorage.getItem("darkMode")==="true";S(t),t&&document.body.classList.add("dark-mode")}return()=>{window.removeEventListener("focus",p),window.removeEventListener("userProfileUpdated",p),window.removeEventListener("visitUpdated",p)}},[s]),a.useEffect(()=>{s&&I()},[g,s]);const p=async()=>{j(!0);const{data:t}=await i.from("user_preferences").select("*").eq("user_id",s.id).maybeSingle();F(t);const{count:r}=await i.from("spots").select("*",{count:"exact",head:!0}).eq("created_by",s.id),{count:y}=await i.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",s.id),{count:b}=await i.from("user_favorites").select("*",{count:"exact",head:!0}).eq("user_id",s.id),{count:z}=await i.from("visited_spots").select("*",{count:"exact",head:!0}).eq("user_id",s.id);E({spots:r||0,reviews:y||0,favorites:b||0,visits:z||0,xp:(r||0)*100+(y||0)*10+(z||0)*5}),j(!1)},I=async()=>{if(k(!0),g==="favorites"){const{data:t}=await i.from("user_favorites").select("spot_id").eq("user_id",s.id);if(t&&t.length>0){const r=t.map(b=>b.spot_id),{data:y}=await i.from("spots").select("*").in("id",r);m(y||[])}else m([])}else if(g==="reviews"){const{data:t}=await i.from("reviews").select("*, spots(name)").eq("user_id",s.id).order("created_at",{ascending:!1});m(t||[])}else if(g==="added"){const{data:t}=await i.from("spots").select("*").eq("created_by",s.id).order("created_at",{ascending:!1});m(t||[])}k(!1)},M=async()=>{await w(),n(`/${d||"en"}/login`)},R=()=>{const t=!h;S(t),t?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),localStorage.setItem("darkMode",t.toString())},T=async()=>{if(s){_(!0);try{const{data:t}=await i.from("user_preferences").select("user_id").eq("username","admin").maybeSingle(),r=t?.user_id;if(!r)throw new Error("Admin user not found. Please contact support.");await i.from("community_posts").delete().eq("user_id",s.id),await i.from("post_comments").delete().eq("user_id",s.id),await i.from("reviews").delete().eq("user_id",s.id),await i.from("user_favorites").delete().eq("user_id",s.id),await i.from("visited_spots").delete().eq("user_id",s.id),await i.from("spots").update({created_by:r}).eq("created_by",s.id),await i.from("user_preferences").delete().eq("user_id",s.id),await i.auth.updateUser({data:{deleted:!0,email:`deleted_${s.id}@deleted.com`}}),await w(),n(`/${d||"en"}/login`)}catch(t){console.error("Error deleting account:",t),alert("Error deleting account: "+t.message)}finally{_(!1),v(!1)}}},q=[{id:"favorites",label:"Favorites",icon:B,count:c.favorites},{id:"reviews",label:"Reviews",icon:P,count:c.reviews},{id:"added",label:"Added",icon:C,count:c.spots}];return e.jsxs("div",{style:{paddingBottom:"120px",background:"var(--bg-white)",minHeight:"100vh"},children:[e.jsx("div",{style:{height:"180px",background:"linear-gradient(135deg, var(--primary) 0%, #FF6B6B 100%)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{style:{position:"absolute",inset:0,opacity:.1,backgroundImage:"radial-gradient(circle at 2px 2px, white 1px, transparent 0)",backgroundSize:"24px 24px"}})}),e.jsxs("div",{style:{marginTop:"-60px",textAlign:"center",padding:"0 20px",position:"relative"},children:[e.jsx(o.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},style:{width:"120px",height:"120px",borderRadius:"40px",background:"white",margin:"0 auto",padding:"6px",boxShadow:"var(--shadow-lg)"},children:e.jsx("div",{style:{width:"100%",height:"100%",borderRadius:"34px",overflow:"hidden",background:"var(--secondary)",display:"flex",alignItems:"center",justifyContent:"center"},children:f?.avatar_url?e.jsx("img",{src:f.avatar_url,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(N,{size:50,color:"var(--text-muted)"})})}),e.jsx("h1",{style:{marginTop:"16px",fontSize:"1.6rem",fontWeight:"900",color:"var(--text-main)",margin:"16px 0 4px 0"},children:f?.display_name||s?.user_metadata?.full_name||"Foodie Voyager"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.95rem",fontWeight:"500"},children:"Elite Level Discoverer â€¢ Kerala, IN"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",padding:"24px 20px"},children:[{label:"Visits",value:c.visits,icon:W},{label:"Reviews",value:c.reviews,icon:$},{label:"Added",value:c.spots,icon:C},{label:"XP",value:c.xp,icon:oe}].map((t,r)=>e.jsxs("div",{style:{background:"var(--secondary)",padding:"16px 8px",borderRadius:"24px",textAlign:"center"},children:[e.jsx(t.icon,{size:20,color:"var(--primary)",style:{marginBottom:"8px"}}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"900",color:"var(--text-main)"},children:t.value}),e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"700",color:"var(--text-muted)",marginTop:"2px"},children:t.label})]},r))}),e.jsx("div",{style:{padding:"0 20px",marginBottom:"20px"},children:e.jsx("div",{style:{display:"flex",gap:"8px",background:"var(--secondary)",padding:"6px",borderRadius:"20px"},children:q.map(t=>e.jsxs("button",{onClick:()=>n(`/${d}/profile/${t.id}`),style:{flex:1,padding:"12px",borderRadius:"16px",background:"transparent",border:"none",fontWeight:"800",fontSize:"0.85rem",color:"var(--text-muted)",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[e.jsx(t.icon,{size:16}),t.label," (",t.count,")"]},t.id))})}),e.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"12px",marginTop:"20px"},children:[e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/settings`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#EEF2FF"},children:e.jsx(ee,{size:22,color:"#4F46E5"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Settings"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/leaderboard`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#FFFBEB"},children:e.jsx(X,{size:22,color:"#F59E0B"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Leaderboard"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/privacy-policy`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#F0FDF4"},children:e.jsx(U,{size:22,color:"#10B981"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Privacy Policy"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/saved-posts`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderRadius:"16px",background:"white",border:"1px solid #E5E7EB",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:t=>t.target.style.background="#F9FAFB",onMouseOut:t=>t.target.style.background="white",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#F0FDF4"},children:e.jsx(H,{size:22,color:"#10B981"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Saved Posts"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>n(`/${d}/contact-admin`),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#FEF2F2"},children:e.jsx(O,{size:22,color:"#EF4444"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Contact Admin"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:R,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:h?"#1F2937":"#FEF3C7"},children:h?e.jsx(J,{size:22,color:"#F59E0B"}):e.jsx(se,{size:22,color:"#F59E0B"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:h?"Dark Mode":"Light Mode"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:M,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid var(--secondary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#F3F4F6"},children:e.jsx(Z,{size:22,color:"#6B7280"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"var(--text-main)"},children:"Logout"})]}),e.jsx(l,{size:20,color:"var(--text-muted)"})]}),e.jsxs(o.div,{whileTap:{scale:.98},onClick:()=>v(!0),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",background:"white",borderRadius:"24px",boxShadow:"0 4px 15px rgba(0,0,0,0.03)",cursor:"pointer",border:"1px solid #FEE2E2"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"14px",background:"#FEE2E2"},children:e.jsx(V,{size:22,color:"#DC2626"})}),e.jsx("span",{style:{fontWeight:"800",fontSize:"1.05rem",color:"#DC2626"},children:"Delete Account"})]}),e.jsx(l,{size:20,color:"#DC2626"})]})]}),D&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"24px",padding:"32px",maxWidth:"400px",width:"100%",textAlign:"center"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"#FEE2E2",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px"},children:e.jsx(ae,{size:30,color:"#DC2626"})}),e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"900",color:"var(--text-main)",marginBottom:"12px"},children:"Delete Account?"}),e.jsx("p",{style:{color:"var(--text-muted)",lineHeight:"1.6",marginBottom:"24px"},children:"This action cannot be undone. All your data including posts, reviews, favorites, and visits will be permanently deleted. Your added spots will be transferred to admin."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:()=>v(!1),disabled:u,style:{flex:1,padding:"16px",borderRadius:"16px",border:"2px solid var(--secondary)",background:"white",color:"var(--text-main)",fontWeight:"800",cursor:u?"not-allowed":"pointer"},children:"Cancel"}),e.jsx("button",{onClick:T,disabled:u,style:{flex:1,padding:"16px",borderRadius:"16px",border:"none",background:"#DC2626",color:"white",fontWeight:"800",cursor:u?"not-allowed":"pointer",opacity:u?.7:1},children:u?"Deleting...":"Delete Forever"})]})]})})]})};export{je as default};
