import{j as t}from"./framer-BMT5hQ7X.js";import{d as v,u as B,r as i}from"./router-DOtJe_Np.js";import{T as C}from"./Toast-BwML1H3D.js";import{M as R}from"./MapPicker-Cq_RzFKm.js";import{u as _,s as b}from"./index-0cjaDKRs.js";import{l as N,e as z,q as F}from"./lucide-DqyMvtym.js";import"./vendor-b0vXyz-r.js";import"./supabase-CtFrdYha.js";const q=({lang:y})=>{const{id:n}=v(),g=B(),{user:u}=_(),[l,m]=i.useState(1),[c,s]=i.useState(!0),[P,T]=i.useState(!1),[f,x]=i.useState(!1),[p,h]=i.useState(null),[r,a]=i.useState({name:"",category:"",price:1,location_text:"",latitude:null,longitude:null,description:"",images:[]});i.useEffect(()=>{n&&j()},[n]);const j=async()=>{s(!0);const{data:e,error:o}=await b.from("spots").select("*").eq("id",n).single();if(o){d("Failed to load spot data.","error"),s(!1);return}a({name:e.name,category:e.category||"Cafe",price:e.price_level||1,location_text:e.location_text,latitude:e.latitude,longitude:e.longitude,description:e.description||"",images:e.images||[]}),s(!1)},k=()=>m(e=>e+1),S=()=>m(e=>e-1),d=(e,o="success")=>{h({message:e,type:o})},w=async e=>{if(e.preventDefault(),!u)return d("Please login first","error");s(!0);try{const{error:o}=await b.from("spot_edits").insert([{spot_id:n,user_id:u.id,data:r,status:"pending"}]);if(o)throw o;d("Edit Suggestion Submitted! Admin will review.","success"),setTimeout(()=>g(`/${y}/home`),2e3)}catch(o){console.error(o),d("Failed to submit edit.","error"),s(!1)}};return c&&l===1?t.jsx("div",{style:{padding:"4rem",textAlign:"center",color:"white"},children:"Loading spot details..."}):t.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #1e293b 0%, #0f172a 100%)",paddingBottom:"100px"},children:[p&&t.jsx(C,{message:p.message,type:p.type,onClose:()=>h(null)}),t.jsx(R,{isOpen:f,onClose:()=>x(!1),onSelectLocation:(e,o)=>a({...r,latitude:e,longitude:o,location_text:`${e.toFixed(4)}, ${o.toFixed(4)}`})}),t.jsxs("div",{className:"container",style:{padding:"2rem 1rem",maxWidth:"600px",margin:"0 auto"},children:[t.jsxs("button",{onClick:()=>g(-1),style:{marginBottom:"1.5rem",background:"rgba(255,255,255,0.1)",color:"white",border:"none",padding:"8px 16px",borderRadius:"20px",cursor:"pointer"},children:[t.jsx(N,{size:20,style:{verticalAlign:"middle"}})," Back"]}),t.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem",color:"white"},children:[t.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:"800"},children:"Suggest Changes ✨"}),t.jsxs("p",{style:{opacity:.8},children:["Help keep ",r.name," info up to date"]})]}),t.jsxs("form",{onSubmit:w,className:"glass-card",style:{padding:"2rem",background:"rgba(255,255,255,0.05)",backdropFilter:"blur(10px)",borderRadius:"24px",border:"1px solid rgba(255,255,255,0.1)",color:"white"},children:[l===1&&t.jsxs("div",{className:"animate-fade-in",children:[t.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.1rem"},children:"Step 1: Basic Info"}),t.jsx("label",{style:{display:"block",marginBottom:"8px",opacity:.8},children:"Spot Name"}),t.jsx("input",{type:"text",value:r.name,onChange:e=>a({...r,name:e.target.value}),style:{width:"100%",padding:"14px",borderRadius:"12px",border:"none",background:"rgba(255,255,255,0.1)",color:"white",marginBottom:"1.5rem"}}),t.jsx("label",{style:{display:"block",marginBottom:"8px",opacity:.8},children:"Description"}),t.jsx("textarea",{value:r.description,onChange:e=>a({...r,description:e.target.value}),style:{width:"100%",padding:"14px",borderRadius:"12px",border:"none",background:"rgba(255,255,255,0.1)",color:"white",minHeight:"120px"}}),t.jsxs("button",{type:"button",onClick:k,style:{width:"100%",marginTop:"2rem",background:"linear-gradient(135deg, #6366f1 0%, #4338ca 100%)",color:"white",padding:"16px",borderRadius:"16px",border:"none",fontWeight:"800",cursor:"pointer"},children:["Next Step ",t.jsx(z,{size:18})]})]}),l===2&&t.jsxs("div",{className:"animate-fade-in",children:[t.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.1rem"},children:"Step 2: Location"}),t.jsxs("button",{type:"button",onClick:()=>x(!0),style:{width:"100%",padding:"14px",background:"rgba(255,255,255,0.1)",color:"white",border:"2px solid rgba(255,255,255,0.2)",borderRadius:"12px",cursor:"pointer",marginBottom:"1rem",fontWeight:"700"},children:[t.jsx(F,{size:18,style:{marginRight:"8px"}})," Update Map Pin"]}),t.jsx("input",{type:"text",placeholder:"Address",value:r.location_text,onChange:e=>a({...r,location_text:e.target.value}),style:{width:"100%",padding:"14px",borderRadius:"12px",border:"none",background:"rgba(255,255,255,0.1)",color:"white",marginBottom:"1.5rem"}}),t.jsx("label",{style:{display:"block",marginBottom:"8px",opacity:.8},children:"Price Level"}),t.jsx("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",marginBottom:"1.5rem"},children:[1,2,3].map(e=>t.jsx("button",{type:"button",onClick:()=>a({...r,price:e}),style:{width:"60px",height:"60px",borderRadius:"20px",background:r.price===e?"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)":"rgba(255,255,255,0.1)",color:"white",border:r.price===e?"none":"2px solid rgba(255,255,255,0.2)",fontWeight:"800",fontSize:"1.2rem",cursor:"pointer",transition:"all 0.3s ease"},children:"₹".repeat(e)},e))}),t.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"2rem"},children:[t.jsx("button",{type:"button",onClick:S,style:{flex:1,padding:"16px",borderRadius:"16px",background:"transparent",border:"1px solid rgba(255,255,255,0.2)",color:"white",cursor:"pointer"},children:"Back"}),t.jsx("button",{type:"submit",disabled:c,style:{flex:2,padding:"16px",borderRadius:"16px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",fontWeight:"800",cursor:"pointer"},children:c?"Submitting...":"Submit Suggestion ✨"})]})]})]})]})]})};export{q as default};
